(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{217:function(e,t,n){e.exports=n.p+"static/media/bycicle.b104a8d2.svg"},218:function(e,t,n){e.exports=n.p+"static/media/logo.aba6572d.svg"},225:function(e,t,n){e.exports=n(458)},458:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(7),c=n.n(i),o=n(41),u=n(42),l=n(45),d=n(43),s=n(44),E=n(77),m=n(26),p=n(59),f=n(15),h=n(16);function g(){var e=Object(f.a)(["\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n\n  justify-content: center;\n  align-items: center;\n  text-align: center;\n"]);return g=function(){return e},e}var b,v=h.a.div(g()),S=function(e){var t=e.textBlock,n=e.actionsBlock;return r.a.createElement(v,null,r.a.createElement("p",null,t),n)},I=n(121),y=function(){return document.location.reload()},O=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={hasError:!1},n}return Object(s.a)(t,e),Object(u.a)(t,[{key:"componentDidCatch",value:function(){this.setState({hasError:!0})}},{key:"render",value:function(){return this.state.hasError?r.a.createElement(S,{textBlock:r.a.createElement(a.Fragment,null,"Something has gone wrong(",r.a.createElement("br",null),"Please reload the page"),actionsBlock:r.a.createElement(I.a,{type:"primary",onClick:y},"Reload")}):this.props.children}}]),t}(a.Component),C=n(76),T=n.n(C),j="#e8e8e8",N="#f5222d",_="https://bikewise.org:443/api/v2",D="Berlin",x="theft";!function(e){e.INCIDENT_REQUEST="INCIDENT_REQUEST",e.INCIDENT_REQUEST_SUCCESS="INCIDENT_REQUEST_SUCCESS",e.INCIDENTS_REQUEST="INCIDENTS_REQUEST",e.INCIDENTS_REQUEST_SUCCESS="INCIDENTS_REQUEST_SUCCESS",e.INCIDENTS_REQUEST_FAILURE="INCIDENTS_REQUEST_FAILURE",e.INCIDENT_POSITION_REQUEST="INCIDENT_POSITION_REQUEST",e.INCIDENT_POSITION_REQUEST_SUCCESS="INCIDENT_POSITION_REQUEST_SUCCESS"}(b||(b={}));var U=function(e){return{id:e.id,title:e.title,description:e.description,incidentDate:e.occurred_at,updateDate:e.updated_at,address:e.address,imageUrl:e.media&&e.media.image_url,imageUrlThumb:e.media&&e.media.image_url_thumb}};var R=n(223),w=n(460),k=n(463),Q=n(151),P=n.n(Q),L=n(9),F=n.n(L);function A(){var e=Object(f.a)(["\n  width: ",";\n  flex-shrink: ",";\n\n  &:not(:last-child) {\n    margin-right: 12px;\n  }\n"]);return A=function(){return e},e}function B(){var e=Object(f.a)(["\n  display: flex;\n  margin-bottom: 32px;\n"]);return B=function(){return e},e}var q=w.a.RangePicker,z=h.a.div(B()),G=h.a.div(A(),function(e){return e.wide?"100%":e.width+"px"},function(e){return e.width?0:void 0}),M=function(e){var t=e.query,n=e.startDate,a=e.endDate,r={};return t&&(r.query=t),n&&(r.startDate=n.format("X")),a&&(r.endDate=a.format("X")),P.a.stringify(r)},H=function(e){function t(e){var n;Object(o.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).handleQueryChange=function(e){n.setState({query:e.target.value})},n.handleDateRangeChange=function(e){var t=Object(R.a)(e,2),a=t[0],r=t[1];n.setState({startDate:a&&a.startOf("day"),endDate:r&&r.endOf("day")})},n.handleSubmit=function(e){e.preventDefault(),n.props.history.push("/?".concat(M(n.state)))};var a=P.a.parse(window.location.search.substr(1)),r=a.query,i=a.startDate,c=a.endDate;return n.state={query:r,startDate:i?F.a.unix(+i):void 0,endDate:c?F.a.unix(+c):void 0},n}return Object(s.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state,t=e.startDate,n=e.endDate;return r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(z,null,r.a.createElement(G,{wide:!0},r.a.createElement(k.a,{onChange:this.handleQueryChange,value:this.state.query,placeholder:"Input description...",allowClear:!0})),r.a.createElement(G,{width:280},r.a.createElement(q,{disabledDate:function(e){return!!e&&e.isAfter()},onChange:this.handleDateRangeChange,value:t&&n?[t,n]:void 0})),r.a.createElement(I.a,{type:"primary",htmlType:"submit"},"Find cases")))}}]),t}(a.Component),Z=n(217),X=n.n(Z),J=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).withTime,n=void 0===t||t;return e?new Date(1e3*e).toLocaleString("en-US",{hour:n?"numeric":void 0,minute:n?"numeric":void 0,weekday:"short",day:"numeric",month:"short",year:"numeric"}).replace(/,/,""):null};function V(){var e=Object(f.a)(["\n  margin-top: auto;\n  align-self: flex-end;\n  font-size: 13px;\n"]);return V=function(){return e},e}function K(){var e=Object(f.a)(["\n  height: 100%;\n"]);return K=function(){return e},e}function W(){var e=Object(f.a)(["\n  width: ","px;\n  height: ","px;\n  border-right: 1px solid ",";\n  border-bottom: 1px solid ",";\n  margin-bottom: -1px;\n  flex-shrink: 0;\n"]);return W=function(){return e},e}function Y(){var e=Object(f.a)(["\n  font-weight: 600;\n  font-size: 20px;\n  line-height: 1.4;\n"]);return Y=function(){return e},e}function $(){var e=Object(f.a)(["\n  padding: 16px 24px;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n"]);return $=function(){return e},e}function ee(){var e=Object(f.a)(["\n  display: flex;\n  border: 1px solid ",";\n  margin: 12px 0;\n"]);return ee=function(){return e},e}var te=h.a.div(ee(),j),ne=h.a.div($()),ae=h.a.div(Y()),re=h.a.div(W(),200,200,j,j),ie=h.a.img(K()),ce=h.a.div(V()),oe=function(e){var t,n,a=e.id,i=e.title,c=e.description,o=e.imageUrlThumb,u=e.address,l=e.incidentDate,d=e.updateDate,s="/incident/".concat(a);return r.a.createElement(te,null,r.a.createElement(m.b,{to:s},r.a.createElement(re,null,r.a.createElement(ie,{src:o||X.a}))),r.a.createElement(ne,null,r.a.createElement(m.b,{to:s},r.a.createElement(ae,null,i)),r.a.createElement("p",null,(n=315,(t=c||"No description").length>n?t.substring(0,function(e,t){for(var n=0;(n=e.indexOf(" ",n+1))>0&&n<t;);return n}(t,n))+"...":t)),r.a.createElement("p",null,!!l&&J(l,{withTime:!1}),!(!l||!u)&&" - ",u),!!d&&r.a.createElement(ce,null,"Updated: ",J(d,{withTime:!1}))))},ue=n(12),le=n(461);function de(){var e=Object(f.a)(["\n  padding-bottom: 12px;\n"]);return de=function(){return e},e}function se(){var e=Object(f.a)(["\n  text-align: right;\n  margin-bottom: 12px;\n"]);return se=function(){return e},e}var Ee=h.a.div(se()),me=h.a.div(de()),pe=function(){return window.scrollTo({top:0,behavior:"smooth"})},fe=function(e,t){switch(t){case"page":return r.a.createElement(m.b,{to:"/?page=".concat(e),onClick:pe},e);case"prev":return e>0?r.a.createElement(m.b,{to:"/?page=".concat(e),onClick:pe},r.a.createElement(ue.a,{type:"left"})):r.a.createElement("a",null,r.a.createElement(ue.a,{type:"left"}));case"next":return r.a.createElement(m.b,{to:"/?page=".concat(e),onClick:pe},r.a.createElement(ue.a,{type:"right"}));case"jump-prev":case"jump-next":return r.a.createElement("span",null,"\u2022\u2022\u2022")}},he=function(e){var t=e.curPageResults,n=e.curPage,i=void 0===n?1:n,c=e.totalCount;return r.a.createElement("div",null,r.a.createElement(Ee,null,"Total: ",c),c<1?r.a.createElement("div",null,"No results"):r.a.createElement(a.Fragment,null,r.a.createElement(me,null,t&&t.map(function(e){return r.a.createElement(oe,Object.assign({},e,{key:e.id}))})),r.a.createElement(le.a,{hideOnSinglePage:!0,current:i,total:c,pageSize:10,itemRender:fe})))},ge=n(218),be=n.n(ge);function ve(){var e=Object(f.a)(["\n  margin: 0;\n  font-weight: 600;\n  font-size: 24px;\n  line-height: 1.35;\n"]);return ve=function(){return e},e}function Se(){var e=Object(f.a)(["\n  margin: 0;\n  font-weight: 600;\n  font-size: 38px;\n  line-height: 1.23;\n"]);return Se=function(){return e},e}function Ie(){var e=Object(f.a)(["\n  width: 100px;\n  height: 100px;\n  margin-right: 32px;\n"]);return Ie=function(){return e},e}function ye(){var e=Object(f.a)(["\n  display: flex;\n  align-items: center;\n  margin-bottom: 32px;\n"]);return ye=function(){return e},e}var Oe=h.a.header(ye()),Ce=h.a.img(Ie()),Te=h.a.h1(Se()),je=h.a.h2(ve()),Ne=function(){return r.a.createElement(Oe,null,r.a.createElement(m.b,{to:"/"},r.a.createElement(Ce,{src:be.a,alt:"logo"})),r.a.createElement("div",null,r.a.createElement(Te,null,"Police Department of Berlin"),r.a.createElement(je,null,"Stolen Bikes")))};function _e(){var e=Object(f.a)(["\n  min-width: 768px;\n  max-width: 1024px;\n  margin: 0 auto;\n  padding: 16px;\n  padding-top: 24px;\n  padding-bottom: 56px;\n"]);return _e=function(){return e},e}var De,xe=h.a.div(_e()),Ue=function(e){var t=e.children;return r.a.createElement(xe,null,r.a.createElement(Ne,null),t)},Re=n(459);!function(e){e.UNINITED="UNINITED",e.FETCHING="FETCHING",e.SUCCESS="SUCCESS",e.FAILURE="FAILURE"}(De||(De={}));function we(){var e=Object(f.a)(["\n  color: ",";\n"]);return we=function(){return e},e}function ke(){var e=Object(f.a)(["\n  padding-top: 42px;\n  text-align: center;\n"]);return ke=function(){return e},e}var Qe=h.a.div(ke()),Pe=h.a.div(we(),N),Le=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.props.dispatch(function(){var e={per_page:1e6,incident_type:"theft",proximity:D};return function(t){return t({type:b.INCIDENTS_REQUEST}),fetch("".concat(_,"/incidents/?").concat(T.a.stringify(e))).then(function(e){return e.json()}).then(function(e){var t=e.incidents;return(void 0===t?[]:t).reduce(function(e,t){return e[t.id]=U(t),e},{})}).then(function(e){return t({type:b.INCIDENTS_REQUEST_SUCCESS,payload:{incidents:e}})}).catch(function(e){return t({type:b.INCIDENTS_REQUEST_FAILURE,payload:{message:e.messsage}})})}}())}},{key:"renderResults",value:function(){var e=this.props,t=e.curPage,n=e.curPageResults,a=void 0===n?[]:n,i=e.incidentsLoadingStatus,c=e.totalResultsCount;switch(i){case De.FETCHING:return r.a.createElement(Qe,null,r.a.createElement(Re.a,{indicator:r.a.createElement(ue.a,{type:"loading",style:{fontSize:42},spin:!0})}));case De.FAILURE:return r.a.createElement(Pe,null,"Something has gone wrong(");default:return r.a.createElement(he,{curPage:t,curPageResults:a,totalCount:c})}}},{key:"render",value:function(){return r.a.createElement(Ue,null,r.a.createElement(H,{history:this.props.history}),this.renderResults())}}]),t}(a.Component),Fe=function(e,t){return e.slice(10*(t-1),10*t)},Ae=Object(E.b)(function(e,t){var n,a=(n=e.incidents.byId,Object.keys(n).map(function(e){return n[e]})).reverse(),r=T.a.parse(t.location.search),i=r.page,c=r.query,o=r.startDate,u=r.endDate,l=+(i||1),d=c&&c.toLowerCase(),s=a.filter(function(e){return!(d&&-1==e.title.toLowerCase().indexOf(d))&&!(o&&o>=e.incidentDate)&&!(u&&u<=e.incidentDate)});return{curPage:l,totalResultsCount:s.length,curPageResults:Fe(s,l),incidentsLoadingStatus:e.incidents.loadingStatus}})(Le),Be=n(39),qe=n(462),ze=n(90);function Ge(){var e=Object(f.a)(["\n  height: 400px;\n  margin-bottom: 12px;\n"]);return Ge=function(){return e},e}var Me=h.a.div(Ge()),He=Object(ze.withScriptjs)(Object(ze.withGoogleMap)(function(e){var t=e.center,n=e.defaultZoom,a=void 0===n?12:n;return r.a.createElement(ze.GoogleMap,{defaultZoom:a,defaultCenter:t},r.a.createElement(ze.Marker,{position:t}))})),Ze=function(e){return r.a.createElement(He,Object.assign({googleMapURL:"https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=geometry,drawing,places&key=".concat("AIzaSyC9NBq_W0KRxYjULZVTJoH_Qh72Z8rN1ZA"),loadingElement:r.a.createElement("div",{style:{height:"100%"}}),containerElement:r.a.createElement(Me,null),mapElement:r.a.createElement("div",{style:{height:"100%"}})},e))};function Xe(e,t){return e.incidents.byId[t]}function Je(e){var t=e.id;return function(e,n){var a=Xe(n(),t),r=a.title,i=a.incidentDate,c={query:r,occurred_after:i,occurred_before:i,incident_type:x};return e({type:b.INCIDENT_POSITION_REQUEST,payload:{query:c}}),fetch("".concat(_,"/locations/?").concat(T.a.stringify(c))).then(function(e){return e.json()}).then(function(e){return e.features.length>1||0===e.features.length?null:e.features[0].geometry.coordinates}).then(function(n){var a=n?{lng:n[0],lat:n[1]}:null;e({type:b.INCIDENT_POSITION_REQUEST_SUCCESS,payload:{id:t,coordinates:a}})})}}function Ve(e){var t=e.id;return function(e){return e(function(e){var t=e.id;return function(e){return e({type:b.INCIDENT_REQUEST}),fetch("".concat(_,"/incidents/").concat(t)).then(function(e){return e.json()}).then(function(e){var t=e.incident;return U(t)}).then(function(n){return e({type:b.INCIDENT_REQUEST_SUCCESS,payload:{id:t,incident:n}})})}}({id:t})).then(function(){return e(Je({id:t}))})}}function Ke(){var e=Object(f.a)(["\n  margin-left: 6px;\n"]);return Ke=function(){return e},e}function We(){var e=Object(f.a)(["\n  margin-bottom: 12px;\n"]);return We=function(){return e},e}var Ye=h.a.div(We()),$e=h.a.span(Ke()),et=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.id,n=e.incidentDate,a=e.dispatch;a(n?Je({id:t}):Ve({id:t}))}},{key:"render",value:function(){var e=this.props,t=e.title,n=e.description,i=e.incidentDate,c=e.address,o=e.coordinates,u=e.updateDate;return r.a.createElement(Ue,null,r.a.createElement(Ye,null,r.a.createElement(m.b,{to:"/"},"Back",r.a.createElement($e,null,r.a.createElement(ue.a,{type:"rollback"})))),r.a.createElement(qe.a.Title,{level:3},t||"Loading..."),r.a.createElement("p",null,r.a.createElement("b",null,"Date stolen:")," ",J(i),r.a.createElement("br",null),r.a.createElement("b",null,"Location:")," ",c,r.a.createElement("br",null),r.a.createElement("b",null,"Report was updated:")," ",J(u)),!!n&&r.a.createElement(a.Fragment,null,r.a.createElement(qe.a.Title,{level:3},"Description of incident"),r.a.createElement("p",null,n)),o&&r.a.createElement(Ze,{center:o}))}}]),t}(a.Component),tt=Object(E.b)(function(e,t){var n=+t.match.params.id;return Object(Be.a)({id:n},Xe(e,n))})(et),nt=function(){return r.a.createElement(S,{textBlock:r.a.createElement(qe.a.Title,null,"Page not found"),actionsBlock:r.a.createElement(m.b,{to:"/"},r.a.createElement(I.a,{type:"primary"},"Go to main page"))})},at=n(57),rt=n(222),it=n(89),ct={byId:[],loadingStatus:De.UNINITED};var ot=Object(at.c)({incidents:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b.INCIDENTS_REQUEST:return Object(Be.a)({},e,{loadingStatus:De.FETCHING});case b.INCIDENTS_REQUEST_FAILURE:return Object(Be.a)({},e,{loadingStatus:De.FAILURE});case b.INCIDENTS_REQUEST_SUCCESS:return Object(Be.a)({},e,{loadingStatus:De.SUCCESS,byId:t.payload.incidents});case b.INCIDENT_REQUEST_SUCCESS:var n=t.payload,a=n.id,r=n.incident;return Object(Be.a)({},e,{byId:Object(Be.a)({},e.byId,Object(it.a)({},a,r))});case b.INCIDENT_POSITION_REQUEST_SUCCESS:var i=t.payload,c=i.id,o=i.coordinates;return Object(Be.a)({},e,{byId:Object(Be.a)({},e.byId,Object(it.a)({},c,Object(Be.a)({},e.byId[c],{coordinates:o})))});default:return e}}}),ut=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||at.d,lt=Object(at.e)(ot,ut(Object(at.a)(rt.a))),dt=(n(457),function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement(O,null,r.a.createElement(E.a,{store:lt},r.a.createElement(m.a,{basename:"/coding-challenge-frontend-react/"},r.a.createElement(p.c,null,r.a.createElement(p.a,{path:"/",exact:!0,component:Ae}),r.a.createElement(p.a,{path:"/incident/:id",component:tt}),r.a.createElement(p.a,{component:nt})))))}}]),t}(a.Component));c.a.render(r.a.createElement(dt,null),document.getElementById("root"))}},[[225,1,2]]]);
//# sourceMappingURL=main.1fb2904d.chunk.js.map